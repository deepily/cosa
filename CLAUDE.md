# CLAUDE.md - Guide for Working with the CoSA Codebase

## Overview
CoSA (Collection of Small Agents) is a Python-based project that implements various AI agents with specialized capabilities. The codebase is organized into modules for agents, utilities, memory management, and tools.

## Project Structure
- `/agents/`: Contains various agent implementations (math, calendar, weather, etc.)
- `/app/`: Core application components and configuration management
- `/memory/`: Data persistence and management components
- `/tools/`: External integrations (search, etc.)
- `/training/`: Model training and tuning utilities
- `/utils/`: Shared utility functions

## Code Style and Conventions
1. Use 4-space indentation (not tabs)
2. Methods and function names use snake_case
3. Class names use PascalCase
4. Constants use UPPER_SNAKE_CASE
5. Utilize XML tags for structured responses in agent communication

## Key Components
- `AgentBase`: Abstract base class for all agents
- `ConfigurationManager`: Manages configuration settings with inheritance capabilities
- `Llm`: Handles interactions with various language models (OpenAI, Groq, Google, etc.)
- `RunnableCode`: Base class for executing code generated by agents

## Configuration Management
- Configuration uses INI files with a custom inheritance system
- Environment variables are used to specify configuration paths
- API keys are stored in `/src/conf/keys/` directory

## Development Workflow
1. New agents should extend `AgentBase` class
2. Agent responses typically use XML format for structured data
3. Agents can generate and execute code via `RunnableCode` class
4. Configuration managed via `ConfigurationManager` singleton
5. Current state tracked via state constants (e.g., `STATE_INITIALIZED`, `STATE_RUNNING`)

## Debugging
- Most classes accept `debug` and `verbose` parameters to control output detail
- Use `print_banner()` from `utils.py` for formatted console messages
- Stack traces can be logged with `print_stack_trace()`

## Best Practices
1. Make use of the existing utilities in `utils.py`
2. Follow the agent pattern established in `AgentBase`
3. Maintain compatibility with the XML response format
4. Add docstrings to new functions and classes
5. Properly handle errors and edge cases
6. Use the `ConfigurationManager` for settings instead of hardcoding values

## Recent Changes (March 2025)
- Refactoring to use external LLM services instead of in-memory models
- Implementing router for directing requests to appropriate LLM endpoints
- Adding completion flag and configuration manager improvements